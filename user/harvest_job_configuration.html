

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Detailed Harvest Configuration &mdash; PDS Registry 1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Update Archive Status" href="update_status.html" />
    <link rel="prev" title="Load Data - Scalable Harvest" href="load2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PDS Registry
          

          
            
            <img src="../_static/PDS_Planets.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About PDS Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud_startup.html">Cloud Startup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tasks.html">User Tasks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="load1.html">Load Data - Standalone Harvest</a></li>
<li class="toctree-l2"><a class="reference internal" href="load2.html">Load Data - Scalable Harvest</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Detailed Harvest Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#node-name">Node Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-directories-and-filters">Input Directories and Filters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#process-directories">Process Directories</a></li>
<li class="toctree-l4"><a class="reference internal" href="#process-a-list-of-files">Process a List of Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-products-by-class">Filtering Products by Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="#process-bundles">Process Bundles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-bundle-versions">Filtering Bundle Versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-bundle-s-collections">Filtering Bundle’s Collections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-bundle-s-product-directories">Filtering Bundle’s Product Directories</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#file-reference-access-url">File Reference / Access URL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#registry-integration">Registry Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#label-and-data-file-information">Label and Data File Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#blob-storage">BLOB Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extract-metadata-by-xpath">Extract Metadata by XPath</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mapping-files">Mapping Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xml-name-spaces">XML Name Spaces</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="update_status.html">Update Archive Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete_data.html">Delete Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../admin/tasks.html">Admin Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support/support.html">Support</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PDS Registry</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="tasks.html">User Tasks</a> &raquo;</li>
        
      <li>Detailed Harvest Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/pds-data-dictionaries/ldd-template/blob/main/docs/source/user/harvest_job_configuration.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="detailed-harvest-configuration">
<h1>Detailed Harvest Configuration<a class="headerlink" href="#detailed-harvest-configuration" title="Permalink to this headline">¶</a></h1>
<p>The following sections describe Harvest configuration file in more detail.</p>
<section id="node-name">
<h2>Node Name<a class="headerlink" href="#node-name" title="Permalink to this headline">¶</a></h2>
<p>Node name is a required parameter which is used to tag ingested data with the node it is ingested by.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
...
</pre></div>
</div>
<dl class="simple">
<dt>One of the following values can be used:</dt><dd><ul class="simple">
<li><p><strong>PDS_ATM</strong>  - Planetary Data System: Atmospheres Node</p></li>
<li><p><strong>PDS_ENG</strong>  - Planetary Data System: Engineering Node</p></li>
<li><p><strong>PDS_GEO</strong>  - Planetary Data System: Geosciences Node</p></li>
<li><p><strong>PDS_IMG</strong>  - Planetary Data System: Imaging Node</p></li>
<li><p><strong>PDS_NAIF</strong> - Planetary Data System: NAIF Node</p></li>
<li><p><strong>PDS_RMS</strong>  - Planetary Data System: Rings Node</p></li>
<li><p><strong>PDS_SBN</strong>  - Planetary Data System: Small Bodies Node at University of Maryland</p></li>
<li><p><strong>PSA</strong>      - Planetary Science Archive</p></li>
<li><p><strong>JAXA</strong>     - Japan Aerospace Exploration Agency</p></li>
<li><p><strong>ROSCOSMOS</strong> - Russian State Corporation for Space Activities</p></li>
</ul>
</dd>
</dl>
<p>This value is saved in “ops:Harvest_Info/ops:node_name” field in the loaded OpenSearch documents:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="p">...</span>
  <span class="s2">&quot;ops:Harvest_Info/ops:node_name&quot;</span><span class="o">:</span> <span class="s2">&quot;PDS_SBN&quot;</span><span class="p">,</span>
<span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="input-directories-and-filters">
<h2>Input Directories and Filters<a class="headerlink" href="#input-directories-and-filters" title="Permalink to this headline">¶</a></h2>
<section id="process-directories">
<h3>Process Directories<a class="headerlink" href="#process-directories" title="Permalink to this headline">¶</a></h3>
<p>To process products from one or more directories, add the following section in Harvest configuration file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;directories&gt;</span>
    <span class="nt">&lt;path&gt;</span>/some-directory/sub-dir-1/<span class="nt">&lt;/path&gt;</span>
    <span class="nt">&lt;path&gt;</span>/some-directory/sub-dir-2/<span class="nt">&lt;/path&gt;</span>
  <span class="nt">&lt;/directories&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You could not have both &lt;directories&gt; and &lt;bundles&gt; sections at the same time.</p>
</div>
</section>
<section id="process-a-list-of-files">
<h3>Process a List of Files<a class="headerlink" href="#process-a-list-of-files" title="Permalink to this headline">¶</a></h3>
<p>First, create a manifest file and list all files you want to process. One file path per line.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">d1</span><span class="o">/</span><span class="n">CCF_0088_0674757853_190FDR_N0040048CACH00100_0A10LLJ05</span><span class="o">.</span><span class="n">xml</span>
<span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">d1</span><span class="o">/</span><span class="n">CCF_0088_0674757853_190FDR_N0040048CACH00100_0A10LLJ07</span><span class="o">.</span><span class="n">xml</span>
<span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">d1</span><span class="o">/</span><span class="n">CCF_0088_0674757853_190FDR_N0040048CACH00100_0A10LLJ09</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>Next, add the following section in Harvest configuration file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;files&gt;</span>
    <span class="nt">&lt;manifest&gt;</span>/some-directory/manifest.txt<span class="nt">&lt;/manifest&gt;</span>
  <span class="nt">&lt;/files&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
</section>
<section id="filtering-products-by-class">
<h3>Filtering Products by Class<a class="headerlink" href="#filtering-products-by-class" title="Permalink to this headline">¶</a></h3>
<p>You can include or exclude products of a particular class. For example, to only process documents, add following
product filter in Harvest configuration file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;productFilter&gt;</span>
    <span class="nt">&lt;includeClass&gt;</span>Product_Document<span class="nt">&lt;/includeClass&gt;</span>
  <span class="nt">&lt;/productFilter&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<p>To exclude documents, add following product filter:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;productFilter&gt;</span>
    <span class="nt">&lt;excludeClass&gt;</span>Product_Document<span class="nt">&lt;/excludeClass&gt;</span>
  <span class="nt">&lt;/productFilter&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You could not have both include and exclude filters at the same time.</p>
</div>
</section>
<section id="process-bundles">
<h3>Process Bundles<a class="headerlink" href="#process-bundles" title="Permalink to this headline">¶</a></h3>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>To process products from one or more bundles, add the following section in Harvest configuration file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;bundles&gt;</span>
    <span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/geo/urn-nasa-pds-kaguya_grs_spectra&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/geo/urn-nasa-pds-trang2020_moon_space_weathering&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bundles&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You could not have both &lt;directories&gt; and &lt;bundles&gt; sections at the same time.</p>
</div>
</section>
<section id="filtering-bundle-versions">
<h3>Filtering Bundle Versions<a class="headerlink" href="#filtering-bundle-versions" title="Permalink to this headline">¶</a></h3>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>Use “versions” attribute of the &lt;bundle&gt; tag to list versions of bundles to process.
You can separate versions by comma, semicolon or space.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;bundles&gt;</span>
    <span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/OREX/orex_spice&quot;</span> <span class="na">versions=</span><span class="s">&quot;7.0;8.0&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bundles&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<p>To process all versions you can use either versions=”all” or no versions attribute at all.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;bundles&gt;</span>
    <span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/OREX/orex_spice&quot;</span> <span class="na">versions=</span><span class="s">&quot;all&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/bundles&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
</section>
<section id="filtering-bundle-s-collections">
<h3>Filtering Bundle’s Collections<a class="headerlink" href="#filtering-bundle-s-collections" title="Permalink to this headline">¶</a></h3>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>By default Harvest will process all collections listed in &lt;Bundle_Member_Entry&gt;
section of a bundle. To process a subset of collections you can provide a list of
lids or lidvids as shown below.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Filter by collection LID --&gt;</span>
<span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/OREX/orex_spice&quot;</span> <span class="na">versions=</span><span class="s">&quot;8.0&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;collection</span> <span class="na">lid=</span><span class="s">&quot;urn:nasa:pds:orex.spice:spice_kernels&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bundle&gt;</span>

<span class="c">&lt;!-- Filter by collection LIDVID --&gt;</span>
<span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/OREX/orex_spice&quot;</span> <span class="na">versions=</span><span class="s">&quot;8.0;7.0&quot;</span> <span class="nt">&gt;</span>
    <span class="nt">&lt;collection</span> <span class="na">lidvid=</span><span class="s">&quot;urn:nasa:pds:orex.spice:spice_kernels::8.0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;collection</span> <span class="na">lidvid=</span><span class="s">&quot;urn:nasa:pds:orex.spice:spice_kernels::7.0&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bundle&gt;</span>
</pre></div>
</div>
</section>
<section id="filtering-bundle-s-product-directories">
<h3>Filtering Bundle’s Product Directories<a class="headerlink" href="#filtering-bundle-s-product-directories" title="Permalink to this headline">¶</a></h3>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>By default Harvest will process all products listed in the collection inventory file.
To process a subset of products you can provide a list of directories.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;bundle</span> <span class="na">dir=</span><span class="s">&quot;/data/OREX/orex_spice&quot;</span> <span class="na">versions=</span><span class="s">&quot;8.0&quot;</span> <span class="nt">&gt;</span>
    <span class="c">&lt;!-- Specify a substring in a relative (to the bundle root) directory name.  --&gt;</span>
    <span class="nt">&lt;product</span> <span class="na">dir=</span><span class="s">&quot;/fk/&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bundle&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="file-reference-access-url">
<h2>File Reference / Access URL<a class="headerlink" href="#file-reference-access-url" title="Permalink to this headline">¶</a></h2>
<p>Harvest extracts absolute paths of product and label files, such as</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ops:Label_File_Info/ops:file_ref&quot;</span><span class="o">:</span><span class="s2">&quot;/tmp/d5/naif0012.xml&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:file_ref&quot;</span><span class="o">:</span><span class="s2">&quot;/tmp/d5/naif0012.tls&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>Note that on Windows, backslashes are replaced with forward slashes and disk letter is included.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ops:Label_File_Info/ops:file_ref&quot;</span><span class="o">:</span><span class="s2">&quot;C:/tmp/d4/bundle_orex_spice_v009.xml&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>To replace a file path prefix with another value, such as a URL, add &lt;fileRef/&gt; tag in Harvest configuration file:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;fileInfo&gt;</span>
  <span class="nt">&lt;fileRef</span> <span class="na">replacePrefix=</span><span class="s">&quot;/C:/tmp/d4/&quot;</span>
           <span class="na">with=</span><span class="s">&quot;https://naif.jpl.nasa.gov/pub/naif/pds/pds4/orex/orex_spice/&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/fileInfo&gt;</span>
</pre></div>
</div>
<p>After running Harvest, you should get different <em>file_ref</em> value:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ops:Label_File_Info/ops:file_ref&quot;</span><span class="o">:</span>
    <span class="s2">&quot;https://naif.jpl.nasa.gov/pub/naif/pds/pds4/orex/orex_spice/bundle_orex_spice_v009.xml&quot;</span>
</pre></div>
</div>
</section>
<section id="registry-integration">
<h2>Registry Integration<a class="headerlink" href="#registry-integration" title="Permalink to this headline">¶</a></h2>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>Standalone Harvest tool loads extracted PDS4 metadata into OpenSearch database.
You have to configure following OpenSearch parameters:</p>
<ul class="simple">
<li><p><strong>url</strong> - Registry (OpenSearch) URL</p></li>
<li><p><strong>index</strong> - OpenSearch index name. This is an optional parameter. Default value is ‘registry’.</p></li>
<li><p><strong>auth</strong> - Registry (OpenSearch) authentication configuration file. This is an optional parameter.</p></li>
</ul>
<p>Below are few examples:</p>
<p><strong>Local OpenSearch instance (localhost)</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;registry</span> <span class="na">url=</span><span class="s">&quot;http://localhost:9200&quot;</span> <span class="na">index=</span><span class="s">&quot;registry&quot;</span> <span class="nt">/&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the URL attribute, always have a port specified, which for PDS Registries in AWS, this port should be 443. If a port is not specified, it will default to the OpenSearch default port of 9200, and any attempted writes/updates of the registry will fail.</p>
</div>
<p><strong>Remote OpenSearch instance (on-prem or cloud)</strong></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
  ...
  <span class="nt">&lt;registry</span> <span class="na">url=</span><span class="s">&quot;https://es-server.mydomain.com:443&quot;</span> <span class="na">index=</span><span class="s">&quot;registry&quot;</span> <span class="na">auth=</span><span class="s">&quot;/path/to/auth.cfg&quot;</span> <span class="nt">/&gt;</span>
  ...
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<p>If your OpenSearch server requires authentication, you have to create an authentication
configuration file and provide following parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># true - trust self-signed certificates; false - don&#39;t trust.</span>
<span class="n">trust</span><span class="o">.</span><span class="n">self</span><span class="o">-</span><span class="n">signed</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">user</span> <span class="o">=</span> <span class="n">pds</span><span class="o">-</span><span class="n">user1</span>
<span class="n">password</span> <span class="o">=</span> <span class="n">mypassword</span>
</pre></div>
</div>
</section>
<section id="label-and-data-file-information">
<h2>Label and Data File Information<a class="headerlink" href="#label-and-data-file-information" title="Permalink to this headline">¶</a></h2>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>By default, Harvest extracts label and data file information, such as file name, mime type, size, and MD5 hash.</p>
<p>Label:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ops:Label_File_Info/ops:creation_date_time&quot;</span><span class="o">:</span><span class="s2">&quot;2020-11-18T22:25:05Z&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Label_File_Info/ops:file_name&quot;</span><span class="o">:</span><span class="s2">&quot;naif0012.xml&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Label_File_Info/ops:file_ref&quot;</span><span class="o">:</span><span class="s2">&quot;/C:/tmp/d5/naif0012.xml&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Label_File_Info/ops:file_size&quot;</span><span class="o">:</span><span class="s2">&quot;3398&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Label_File_Info/ops:md5_checksum&quot;</span><span class="o">:</span><span class="s2">&quot;69ea2974a93854d90399b8b8fc3d1334&quot;</span>
</pre></div>
</div>
<p>Data file:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ops:Data_File_Info/ops:creation_date_time&quot;</span><span class="o">:</span><span class="s2">&quot;2020-11-18T22:25:17Z&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:file_name&quot;</span><span class="o">:</span><span class="s2">&quot;naif0012.tls&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:file_ref&quot;</span><span class="o">:</span><span class="s2">&quot;/C:/tmp/d5/naif0012.tls&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:file_size&quot;</span><span class="o">:</span><span class="s2">&quot;5257&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:md5_checksum&quot;</span><span class="o">:</span><span class="s2">&quot;25a2fff30b0dedb4d76c06727b1895b1&quot;</span><span class="p">,</span>
<span class="s2">&quot;ops:Data_File_Info/ops:mime_type&quot;</span><span class="o">:</span><span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</pre></div>
</div>
<p>If you don’t want to process data files, add the following flag in Harvest configuration file.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;fileInfo</span> <span class="na">processDataFiles=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</section>
<section id="blob-storage">
<h2>BLOB Storage<a class="headerlink" href="#blob-storage" title="Permalink to this headline">¶</a></h2>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>By default, Harvest stores PDS product labels as BLOBs (Binary Large OBjects).
Both original PDS product labels in XML format as well as product labels converted to JSON are stored.
The data is compressed and stored in following fields: <em>“ops/Label_File_Info/ops/blob”</em> and <em>“ops/Label_File_Info/ops/json_blob”</em>.</p>
<p>You can expect up to 900% compression rate for some files.
For example, many LADEE housekeeping labels are about 45KB. Compressed BLOB size is about 5KB.
For smaller files, such as collection labels, compression rate is about 350% (5.5KB file is compressed to 1.6KB).</p>
<p>After loading data into OpenSearch, you can extract original labels by running Registry Manager tool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">registry</span><span class="o">-</span><span class="n">manager</span> <span class="n">export</span><span class="o">-</span><span class="n">file</span> \
    <span class="o">-</span><span class="n">lidvid</span> <span class="n">urn</span><span class="p">:</span><span class="n">nasa</span><span class="p">:</span><span class="n">pds</span><span class="p">:</span><span class="n">ladee_ldex</span><span class="p">:</span><span class="n">data_calibrated</span><span class="p">::</span><span class="mf">1.2</span> \
    <span class="o">-</span><span class="n">file</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">data_calibrated</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>To disable BLOB storage, modify <em>fileInfo</em> section in Harvest configuration file.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;fileInfo</span> <span class="na">storeLabels=</span><span class="s">&quot;false&quot;</span> <span class="na">storeJsonLabels=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</section>
<section id="extract-metadata-by-xpath">
<h2>Extract Metadata by XPath<a class="headerlink" href="#extract-metadata-by-xpath" title="Permalink to this headline">¶</a></h2>
<p>(only applies to <strong>command line harvest</strong>)</p>
<p>To extract metadata by XPath, you have to create one or more mapping files and list them
in Harvest configuration file as shown below.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;harvest</span> <span class="na">nodeName=</span><span class="s">&quot;PDS_SBN&quot;</span><span class="nt">&gt;</span>
...
  <span class="nt">&lt;xpathMaps</span> <span class="na">baseDir=</span><span class="s">&quot;/home/pds/harvest/conf&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xpathMap</span> <span class="na">filePath=</span><span class="s">&quot;common.xml&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;xpathMap</span> <span class="na">rootElement=</span><span class="s">&quot;Product_Observational&quot;</span> <span class="na">filePath=</span><span class="s">&quot;observational.xml&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/xpathMaps&gt;</span>
<span class="nt">&lt;/harvest&gt;</span>
</pre></div>
</div>
<p>In the example above there are two <em>xpathMap</em> entries. Each entry must have <em>filePath</em> attribute
pointing to a mapping file. A path can be either absolute or relative to the <em>baseDir</em> attribute
of the <em>xpathMaps</em> tag. The <em>baseDir</em> attribute is optional. The same example with absolute paths
is shown below.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xpathMaps&gt;</span>
  <span class="nt">&lt;xpathMap</span> <span class="na">filePath=</span><span class="s">&quot;/home/pds/harvest/conf/common.xml&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;xpathMap</span> <span class="na">rootElement=</span><span class="s">&quot;Product_Observational&quot;</span>
            <span class="na">filePath=</span><span class="s">&quot;/home/pds/harvest/conf/observational.xml&quot;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/xpathMaps&gt;</span>
</pre></div>
</div>
<p>An <em>xpathMap</em> entry can have optional <em>rootElement</em> attribute.
Without this attribute, XPaths queries defined in a mapping file (<em>common.xml</em>),
will run against every XML document processed by Harvest.
With <em>rootElement</em> attribute, only XMLs with that root element will be processed.</p>
<section id="mapping-files">
<h3>Mapping Files<a class="headerlink" href="#mapping-files" title="Permalink to this headline">¶</a></h3>
<p>A mapping file has one or more entries which map an output field name to an XPath query.
For example, to extract <em>start_date_time</em> and <em>stop_date_time</em> from observational products,
you can use the following file.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;xpaths&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;start_date_time&quot;</span><span class="nt">&gt;</span>/Product_Observational/Observation_Area/Time_Coordinates/start_date_time<span class="nt">&lt;/xpath&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;stop_date_time&quot;</span><span class="nt">&gt;</span>/Product_Observational/Observation_Area/Time_Coordinates/stop_date_time<span class="nt">&lt;/xpath&gt;</span>
<span class="nt">&lt;/xpaths&gt;</span>
<span class="nt">&lt;/source&gt;</span>
</pre></div>
</div>
<p>You can use optional <em>dataType=”date”</em> attribute to convert valid PDS dates to
ISO-8601 “instant” format (e.g., “2013-10-24T00:49:37.457Z”).</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xpaths&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;start_date_time&quot;</span>
         <span class="na">dataType=</span><span class="s">&quot;date&quot;</span><span class="nt">&gt;</span>/Product_Observational/Observation_Area/Time_Coordinates/start_date_time<span class="nt">&lt;/xpath&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;stop_date_time&quot;</span>
         <span class="na">dataType=</span><span class="s">&quot;date&quot;</span><span class="nt">&gt;</span>/Product_Observational/Observation_Area/Time_Coordinates/stop_date_time<span class="nt">&lt;/xpath&gt;</span>
<span class="nt">&lt;/xpaths&gt;</span>
</pre></div>
</div>
</section>
<section id="xml-name-spaces">
<h3>XML Name Spaces<a class="headerlink" href="#xml-name-spaces" title="Permalink to this headline">¶</a></h3>
<p>Harvest ignores namespaces when extracting metadata by XPath.
Below is a fragment of LADEE UVS product label which uses “ladee” namespace for mission area fields.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Observation_Area&gt;</span>
  <span class="nt">&lt;Mission_Area&gt;</span>
    <span class="nt">&lt;ladee:latitude&gt;</span>17.2367925372247<span class="nt">&lt;/ladee:latitude&gt;</span>
    <span class="nt">&lt;ladee:longitude&gt;</span>194.054477731391<span class="nt">&lt;/ladee:longitude&gt;</span>
    ...
</pre></div>
</div>
<p>To extract latitude and longitude you can use the following XPaths without namespaces.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;xpaths&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;latitude&quot;</span><span class="nt">&gt;</span>//Mission_Area/latitude<span class="nt">&lt;/xpath&gt;</span>
  <span class="nt">&lt;xpath</span> <span class="na">fieldName=</span><span class="s">&quot;longitude&quot;</span><span class="nt">&gt;</span>//Mission_Area/longitude<span class="nt">&lt;/xpath&gt;</span>
<span class="nt">&lt;/xpaths&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="update_status.html" class="btn btn-neutral float-right" title="Update Archive Status" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="load2.html" class="btn btn-neutral float-left" title="Load Data - Scalable Harvest" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022 California Institute of Technology

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>